



<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
      
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-4.4.0">
    
    
      
        <title>vae</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/application.0284f74d.css">
      
      
    
    
      <script src="../../assets/javascripts/modernizr.74668098.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../../assets/fonts/material-icons.css">
    
    
    
      
    
    
  </head>
  
    <body dir="ltr">
  
    <svg class="md-svg">
      <defs>
        
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#_1" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="../.." title="osljw" class="md-header-nav__button md-logo">
          
            <i class="md-icon"></i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            <span class="md-header-nav__topic">
              osljw
            </span>
            <span class="md-header-nav__topic">
              
                vae
              
            </span>
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
          
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="../.." title="osljw" class="md-nav__button md-logo">
      
        <i class="md-icon"></i>
      
    </a>
    osljw
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../.." title="Welcome to MkDocs" class="md-nav__link">
      Welcome to MkDocs
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2" checked>
    
    <label class="md-nav__link" for="nav-2">
      Machine Learning
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        Machine Learning
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../2018-11-19-tensorflow_estimator/" title="Tensorflow Estimator" class="md-nav__link">
      Tensorflow Estimator
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        vae
      </label>
    
    <a href="./" title="vae" class="md-nav__link md-nav__link--active">
      vae
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#_1" title="基础知识" class="md-nav__link">
    基础知识
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kl-divergence" title="KL divergence" class="md-nav__link">
    KL divergence
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kl-divergence-elbo-marginal-log-likelihood" title="KL divergence || ELBO || marginal log-likelihood" class="md-nav__link">
    KL divergence || ELBO || marginal log-likelihood
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kl" title="KL 散度的计算" class="md-nav__link">
    KL 散度的计算
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_2" title="代码实验" class="md-nav__link">
    代码实验
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../2018-11-27-unsupervised learning/" title="Unsupervised Clustering" class="md-nav__link">
      Unsupervised Clustering
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../2018-12-03-tensorflow_test/" title="tensorflow test" class="md-nav__link">
      tensorflow test
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../2018-12-05-vade/" title="vade" class="md-nav__link">
      vade
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../2019-03-01-data input/" title="data input" class="md-nav__link">
      data input
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../2019-06-20-tensorflow/" title="2019 06 20 tensorflow" class="md-nav__link">
      2019 06 20 tensorflow
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../2019-06-21-tensorflow_eager/" title="2019 06 21 tensorflow eager" class="md-nav__link">
      2019 06 21 tensorflow eager
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../2019-11-19-keras tensorflow/" title="Tensorflow Keras" class="md-nav__link">
      Tensorflow Keras
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      Algorithm
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        Algorithm
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../algorithm/2018-12-11-binary tree/" title="jekyll blog" class="md-nav__link">
      jekyll blog
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4">
    
    <label class="md-nav__link" for="nav-4">
      Android
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        Android
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../android/2019-04-21-scrcpy/" title="2019 04 21 scrcpy" class="md-nav__link">
      2019 04 21 scrcpy
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../android/2019-05-11-android/" title="2019 05 11 android" class="md-nav__link">
      2019 05 11 android
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      Bigdata
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        Bigdata
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../bigdata/2019-06-04-hive/" title="2019 06 04 hive" class="md-nav__link">
      2019 06 04 hive
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6">
    
    <label class="md-nav__link" for="nav-6">
      Cpp
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-6">
        Cpp
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../cpp/2019-04-17-build_system/" title="����" class="md-nav__link">
      ����
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cpp/2019-04-17-regress_test/" title="2019 04 17 regress test" class="md-nav__link">
      2019 04 17 regress test
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cpp/2019-04-18-project/" title="����" class="md-nav__link">
      ����
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cpp/2019-04-22-time/" title="2019 04 22 time" class="md-nav__link">
      2019 04 22 time
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cpp/2019-04-23-thrift/" title="2019 04 23 thrift" class="md-nav__link">
      2019 04 23 thrift
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cpp/2019-04-29-multi thread/" title="2019 04 29 multi thread" class="md-nav__link">
      2019 04 29 multi thread
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cpp/2019-05-07-ptmalloc/" title="2019 05 07 ptmalloc" class="md-nav__link">
      2019 05 07 ptmalloc
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cpp/2019-05-10-inotify/" title="2019 05 10 inotify" class="md-nav__link">
      2019 05 10 inotify
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cpp/2019-05-20-boost/" title="2019 05 20 boost" class="md-nav__link">
      2019 05 20 boost
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cpp/2019-05-20-smart_ptr/" title="2019 05 20 smart ptr" class="md-nav__link">
      2019 05 20 smart ptr
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cpp/2019-05-21-google/" title="2019 05 21 google" class="md-nav__link">
      2019 05 21 google
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cpp/2019-06-10-stl/" title="2019 06 10 stl" class="md-nav__link">
      2019 06 10 stl
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7" type="checkbox" id="nav-7">
    
    <label class="md-nav__link" for="nav-7">
      Ctr
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-7">
        Ctr
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../ctr/2019-02-17-xdeepfm/" title="xdeepfm" class="md-nav__link">
      xdeepfm
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8" type="checkbox" id="nav-8">
    
    <label class="md-nav__link" for="nav-8">
      Domain algo
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-8">
        Domain algo
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../domain algo/2019-01-08-bandit/" title="bandit" class="md-nav__link">
      bandit
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-9" type="checkbox" id="nav-9">
    
    <label class="md-nav__link" for="nav-9">
      Gcc
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-9">
        Gcc
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../gcc/2019-04-18-ldd/" title="����" class="md-nav__link">
      ����
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../gcc/2019-04-19-gdb/" title="2019 04 19 gdb" class="md-nav__link">
      2019 04 19 gdb
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-10" type="checkbox" id="nav-10">
    
    <label class="md-nav__link" for="nav-10">
      Hack
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-10">
        Hack
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../hack/2019-06-12-sql inject/" title="2019 06 12 sql inject" class="md-nav__link">
      2019 06 12 sql inject
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-11" type="checkbox" id="nav-11">
    
    <label class="md-nav__link" for="nav-11">
      Illusion
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-11">
        Illusion
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../illusion/2019-06-26-illusion/" title="2019 06 26 illusion" class="md-nav__link">
      2019 06 26 illusion
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-12" type="checkbox" id="nav-12">
    
    <label class="md-nav__link" for="nav-12">
      Java
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-12">
        Java
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../java/2019-05-13-reflection/" title="2019 05 13 reflection" class="md-nav__link">
      2019 05 13 reflection
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-13" type="checkbox" id="nav-13">
    
    <label class="md-nav__link" for="nav-13">
      Jekyll
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-13">
        Jekyll
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../jekyll/2018-11-19-jekyll blog/" title="jekyll blog" class="md-nav__link">
      jekyll blog
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../jekyll/mkdocs/" title="mkdocs" class="md-nav__link">
      mkdocs
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-14" type="checkbox" id="nav-14">
    
    <label class="md-nav__link" for="nav-14">
      Linux
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-14">
        Linux
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../linux/2018-12-29-shell/" title="shell" class="md-nav__link">
      shell
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../linux/2019-05-05-route/" title="2019 05 05 route" class="md-nav__link">
      2019 05 05 route
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../linux/2019-05-17-vim/" title="2019 05 17 vim" class="md-nav__link">
      2019 05 17 vim
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../linux/2019-05-18-network/" title="2019 05 18 network" class="md-nav__link">
      2019 05 18 network
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../linux/2019-05-30-git/" title="2019 05 30 git" class="md-nav__link">
      2019 05 30 git
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-15" type="checkbox" id="nav-15">
    
    <label class="md-nav__link" for="nav-15">
      Notes
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-15">
        Notes
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../notes/2018-04-24-leran_markdown/" title="Markdown学习笔记" class="md-nav__link">
      Markdown学习笔记
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-16" type="checkbox" id="nav-16">
    
    <label class="md-nav__link" for="nav-16">
      Python
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-16">
        Python
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../python/2019-02-01-pandas/" title="pandas" class="md-nav__link">
      pandas
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../python/2019-05-05-pip/" title="2019 05 05 pip" class="md-nav__link">
      2019 05 05 pip
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../python/2019-05-17-os/" title="2019 05 17 os" class="md-nav__link">
      2019 05 17 os
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../python/2019-05-22-mouse_keyboard/" title="2019 05 22 mouse keyboard" class="md-nav__link">
      2019 05 22 mouse keyboard
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../python/2020-03-01-sns/" title="sns" class="md-nav__link">
      sns
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-17" type="checkbox" id="nav-17">
    
    <label class="md-nav__link" for="nav-17">
      Spark
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-17">
        Spark
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../spark/2018-12-29-pyspark/" title="spark" class="md-nav__link">
      spark
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-18" type="checkbox" id="nav-18">
    
    <label class="md-nav__link" for="nav-18">
      Web
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-18">
        Web
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../web/2019-05-24-electron/" title="2019 05 24 electron" class="md-nav__link">
      2019 05 24 electron
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../web/2019-05-31-d3/" title="2019 05 31 d3" class="md-nav__link">
      2019 05 31 d3
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#_1" title="基础知识" class="md-nav__link">
    基础知识
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kl-divergence" title="KL divergence" class="md-nav__link">
    KL divergence
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kl-divergence-elbo-marginal-log-likelihood" title="KL divergence || ELBO || marginal log-likelihood" class="md-nav__link">
    KL divergence || ELBO || marginal log-likelihood
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kl" title="KL 散度的计算" class="md-nav__link">
    KL 散度的计算
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_2" title="代码实验" class="md-nav__link">
    代码实验
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                  <h1>vae</h1>
                
                <p>https://kexue.fm/search/%E5%8F%98%E5%88%86%E8%87%AA%E7%BC%96%E7%A0%81%E5%99%A8/</p>
<p>变分自编码器（一）：原来是这么一回事 
https://kexue.fm/archives/5253</p>
<p>基于CNN和VAE的作诗机器人：随机成诗
https://kexue.fm/archives/5332</p>
<h2 id="_1">基础知识</h2>
<ul>
<li>KL divergence（KL散度）：计算两个分布之间的差异， KL散度值越小两个分布越接近</li>
<li>Reparameterization Trick（重参数化技巧）： 解决抽样过程导致的不可导问题,使梯度能够从decoder传递到encoder部分 </li>
<li>ELBO(Evidence Lower BOund): KL公式中存在后验概率无法直接求解，最小化KL等价于最大化ELBO</li>
</ul>
<p>VAE：https://zhuanlan.zhihu.com/p/34998569</p>
<p>编码器(encoder)的输出为高斯分布参数(均值和方差)，两个向量分别为均值向量和方差向量， 根据均值和方差进行采样产生解码器(decoder)的输入向量， 使用KL散度来对分布进行约束</p>
<ul>
<li>AE(autoencoder)</li>
<li>VAE(variational autoencoder)</li>
<li>
<p>CVAE(conditional variational autoencoder)</p>
</li>
<li>
<p>GAN(generative adversarial network)</p>
</li>
</ul>
<h3 id="kl-divergence">KL divergence</h3>
<p>从P到Q的KL散度：</p>
<div>
<div class="MathJax_Preview"> D_{KL}(P||Q)=-\sum p(x)log(q(x)) + \sum p(x)log(p(x))= H(P,Q) - H(P) </div>
<script type="math/tex; mode=display"> D_{KL}(P||Q)=-\sum p(x)log(q(x)) + \sum p(x)log(p(x))= H(P,Q) - H(P) </script>
</div>
<p><span><span class="MathJax_Preview">H(P,Q)</span><script type="math/tex">H(P,Q)</script></span> 为P和Q的交叉熵， <span><span class="MathJax_Preview">H(P)</span><script type="math/tex">H(P)</script></span> 为P的熵</p>
<h3 id="kl-divergence-elbo-marginal-log-likelihood">KL divergence || ELBO || marginal log-likelihood</h3>
<p>给定数据集<span><span class="MathJax_Preview">X=\{ x^{(i)} \}^N_{i=1}</span><script type="math/tex">X=\{ x^{(i)} \}^N_{i=1}</script></span>, 损失函数定义为<span><span class="MathJax_Preview">\sum logp(x^{(i)})</span><script type="math/tex">\sum logp(x^{(i)})</script></span>, 对于每个数据点i， </p>
<p>$$
logp(x^{(i)}) = 
$$
- <span><span class="MathJax_Preview">p(z|x^{(i)})</span><script type="math/tex">p(z|x^{(i)})</script></span>给定样本<span><span class="MathJax_Preview">x^{(i)}</span><script type="math/tex">x^{(i)}</script></span>后z的真实分布
- <span><span class="MathJax_Preview">q(z|x^{(i)})</span><script type="math/tex">q(z|x^{(i)})</script></span>由神经网络给出，可以通过蒙特卡洛估计得到</p>
<div>
<div class="MathJax_Preview">
\begin{aligned} 
KL \big(q(z|x^{(i)}) \big\Vert p(z|x^{(i)})\big) 
&amp;= E_{q(z|x^{(i)})} \big[ \log \frac{q(z|x^{(i)})}{p(z \vert x^{(i)})} \big]\\
&amp;= E_{q(z|x^{(i)})} \big[ \log \frac{q(z|x^{(i)})p(x^{(i)})} {p(z,x^{(i)})} \big] \\
&amp;= E_{q(z|x^{(i)})} \big[ \log \frac{q(z|x^{(i)})}{p(z,x^{(i)})} \big] + \log p(x^{(i)}) \\ 
&amp;= - \mathcal{L} + \log p(x^{(i)})
\end{aligned}
</div>
<script type="math/tex; mode=display">
\begin{aligned} 
KL \big(q(z|x^{(i)}) \big\Vert p(z|x^{(i)})\big) 
&= E_{q(z|x^{(i)})} \big[ \log \frac{q(z|x^{(i)})}{p(z \vert x^{(i)})} \big]\\
&= E_{q(z|x^{(i)})} \big[ \log \frac{q(z|x^{(i)})p(x^{(i)})} {p(z,x^{(i)})} \big] \\
&= E_{q(z|x^{(i)})} \big[ \log \frac{q(z|x^{(i)})}{p(z,x^{(i)})} \big] + \log p(x^{(i)}) \\ 
&= - \mathcal{L} + \log p(x^{(i)})
\end{aligned}
</script>
</div>
<div>
<div class="MathJax_Preview">\log p(x^{(i)}) = KL \big(q(z|x^{(i)}) \big\Vert p(z|x^{(i)})\big) + \mathcal{L}</div>
<script type="math/tex; mode=display">\log p(x^{(i)}) = KL \big(q(z|x^{(i)}) \big\Vert p(z|x^{(i)})\big) + \mathcal{L}</script>
</div>
<p>其中<span><span class="MathJax_Preview">\mathcal{L}</span><script type="math/tex">\mathcal{L}</script></span>即为ELBO, 由于KL是非负的， 因此<span><span class="MathJax_Preview">\log p(x^{(i)}) &gt;= \mathcal{L}</span><script type="math/tex">\log p(x^{(i)}) >= \mathcal{L}</script></span>, ELBO是极大似然<span><span class="MathJax_Preview">\log p(x^{(i)})</span><script type="math/tex">\log p(x^{(i)})</script></span>的下界</p>
<div>
<div class="MathJax_Preview">
\begin{aligned} 
ELBO &amp;=\mathcal{L} \\
&amp;= -E_{q(z|x^{(i)})} \big[ \log \frac{q(z|x^{(i)})}{p(z,x^{(i)})} \big] \\
&amp;= -E_{q(z|x^{(i)})} \big[ \log \frac{q(z|x^{(i)})}{p(x^{(i)}|z)p(z)} \big] \\
&amp;= -E_{q(z|x^{(i)})} \big[ \log \frac{q(z|x^{(i)})}{p(z)} \big]+ E_{q(z|x^{(i)})} \big[ \log p(x^{(i)} \vert z) \big] \\
&amp;= -KL(q(z|x^{(i)}) \Vert p(z)) + E_{q(z|x^{(i)})} \big[ \log p(x^{(i)} \vert z) \big] \\
&amp;= E_{q(z|x^{(i)})} \big[ \log p(z) \big] - E_{q(z|x^{(i)})} \big[ \log q(z |x^{(i)}) \big] + E_{q(z|x^{(i)})} \big[ \log p(x^{(i)} \vert z) \big]
\end{aligned}
</div>
<script type="math/tex; mode=display">
\begin{aligned} 
ELBO &=\mathcal{L} \\
&= -E_{q(z|x^{(i)})} \big[ \log \frac{q(z|x^{(i)})}{p(z,x^{(i)})} \big] \\
&= -E_{q(z|x^{(i)})} \big[ \log \frac{q(z|x^{(i)})}{p(x^{(i)}|z)p(z)} \big] \\
&= -E_{q(z|x^{(i)})} \big[ \log \frac{q(z|x^{(i)})}{p(z)} \big]+ E_{q(z|x^{(i)})} \big[ \log p(x^{(i)} \vert z) \big] \\
&= -KL(q(z|x^{(i)}) \Vert p(z)) + E_{q(z|x^{(i)})} \big[ \log p(x^{(i)} \vert z) \big] \\
&= E_{q(z|x^{(i)})} \big[ \log p(z) \big] - E_{q(z|x^{(i)})} \big[ \log q(z |x^{(i)}) \big] + E_{q(z|x^{(i)})} \big[ \log p(x^{(i)} \vert z) \big]
\end{aligned}
</script>
</div>
<p>ELBO 三项求解
- <span><span class="MathJax_Preview">E_{q(z|x^{(i)})} \big[ \log p(z) \big]</span><script type="math/tex">E_{q(z|x^{(i)})} \big[ \log p(z) \big]</script></span>求解：
p(z) 为隐变量z的先验分布，已知为高斯分布，该项可以求得解析解</p>
<div>
<div class="MathJax_Preview">
E_{q(z|x^{(i)})} \big[ \log p(z) \big] = \int 
</div>
<script type="math/tex; mode=display">
E_{q(z|x^{(i)})} \big[ \log p(z) \big] = \int 
</script>
</div>
<p>logp(x) marginal log-likelihood 
- marginal 指边缘分布， 边缘分布p(x)是相对于p(x, z)联合分布的概念
- log-likelihood 对数似然</p>
<p><span><span class="MathJax_Preview">logp(x^{(i)})=\log p(x^{(i)}) +</span><script type="math/tex">logp(x^{(i)})=\log p(x^{(i)}) +</script></span>  </p>
<h3 id="kl">KL 散度的计算</h3>
<p>离散随机变量X服从P(X),</p>
<div>
<div class="MathJax_Preview"> 
P(X)=
\begin{cases}
0.2, &amp; \text{X = 1} \\
0.4, &amp; \text{X = 2} \\
0.4,  &amp; \text{X = 3}
\end{cases}
</div>
<script type="math/tex; mode=display"> 
P(X)=
\begin{cases}
0.2, & \text{X = 1} \\
0.4, & \text{X = 2} \\
0.4,  & \text{X = 3}
\end{cases}
</script>
</div>
<p>离散随机变量Y服从Q(Y),</p>
<div>
<div class="MathJax_Preview"> 
Q(X)=
\begin{cases}
0.2, &amp; \text{X = 1} \\
0.4, &amp; \text{X = 2} \\
0.4,  &amp; \text{X = 3}
\end{cases}
</div>
<script type="math/tex; mode=display"> 
Q(X)=
\begin{cases}
0.2, & \text{X = 1} \\
0.4, & \text{X = 2} \\
0.4,  & \text{X = 3}
\end{cases}
</script>
</div>
<p>则从P到Q的KL散度为：</p>
<div>
<div class="MathJax_Preview">
D(P||Q)=0.2 \times log(\frac{0.2}{0.4}) + 
0.4 \times log(\frac{0.4}{0.2}) +
0.4 \times log(\frac{0.4}{0.4}) = 0.138
</div>
<script type="math/tex; mode=display">
D(P||Q)=0.2 \times log(\frac{0.2}{0.4}) + 
0.4 \times log(\frac{0.4}{0.2}) +
0.4 \times log(\frac{0.4}{0.4}) = 0.138
</script>
</div>
<p>对于离散随机变量，计算KL散度需要知道随机变量的取值和概率</p>
<p><span><span class="MathJax_Preview">X=g(Z)</span><script type="math/tex">X=g(Z)</script></span> 从隐变量Z生成随机变量X， 隐变量Z为n维向量，每一维均服从标准正态分布， 随机变量X为我们需要生成的数据，例如图像， 如何得到变换函数g使得生成的图像X和真实图像很像呢？ 描述生成的图像是否与真实图像很像，其实是说生成的图像和真实图像的分布是否一致，可以通过KL散度来描述， 但是我们无法直接计算KL散度，因为图像真实分布的概率我们无法拿到。</p>
<p>图像用随机变量X来表达， 记其概率分布为P(X), P(X)的表达式现在未知，否则我们直接可以由表达式生成图像， 我们借用<span><span class="MathJax_Preview">P(X)=P(X|Z)P(Z)</span><script type="math/tex">P(X)=P(X|Z)P(Z)</script></span> 来获得P(X), 随机变量Z的概率分布P(Z)为标准正态分布， P（X|Z) 为Z变换到X的概率分布, 对应vae中的生成器</p>
<p>拟合的分布<span><span class="MathJax_Preview">q(z|x_i)</span><script type="math/tex">q(z|x_i)</script></span>和真实的分布<span><span class="MathJax_Preview">p(z|x_i)</span><script type="math/tex">p(z|x_i)</script></span>的差距如何衡量？</p>
<div>
<div class="MathJax_Preview">
\begin{aligned}&amp;KL\Big(N(\mu,\sigma^2)\Big\Vert N(0,1)\Big)\\ 
=&amp;\int \frac{1}{\sqrt{2\pi\sigma^2}}e^{-(x-\mu)^2/2\sigma^2} \left(\log \frac{e^{-(x-\mu)^2/2\sigma^2}/\sqrt{2\pi\sigma^2}}{e^{-x^2/2}/\sqrt{2\pi}}\right)dx\\ 
=&amp;\int \frac{1}{\sqrt{2\pi\sigma^2}}e^{-(x-\mu)^2/2\sigma^2} \log \left\{\frac{1}{\sqrt{\sigma^2}}\exp\left\{\frac{1}{2}\big[x^2-(x-\mu)^2/\sigma^2\big]\right\} \right\}dx\\ 
=&amp;\frac{1}{2}\int \frac{1}{\sqrt{2\pi\sigma^2}}e^{-(x-\mu)^2/2\sigma^2} \Big[-\log \sigma^2+x^2-(x-\mu)^2/\sigma^2 \Big] dx\end{aligned}
</div>
<script type="math/tex; mode=display">
\begin{aligned}&KL\Big(N(\mu,\sigma^2)\Big\Vert N(0,1)\Big)\\ 
=&\int \frac{1}{\sqrt{2\pi\sigma^2}}e^{-(x-\mu)^2/2\sigma^2} \left(\log \frac{e^{-(x-\mu)^2/2\sigma^2}/\sqrt{2\pi\sigma^2}}{e^{-x^2/2}/\sqrt{2\pi}}\right)dx\\ 
=&\int \frac{1}{\sqrt{2\pi\sigma^2}}e^{-(x-\mu)^2/2\sigma^2} \log \left\{\frac{1}{\sqrt{\sigma^2}}\exp\left\{\frac{1}{2}\big[x^2-(x-\mu)^2/\sigma^2\big]\right\} \right\}dx\\ 
=&\frac{1}{2}\int \frac{1}{\sqrt{2\pi\sigma^2}}e^{-(x-\mu)^2/2\sigma^2} \Big[-\log \sigma^2+x^2-(x-\mu)^2/\sigma^2 \Big] dx\end{aligned}
</script>
</div>
<p>化简后得到：</p>
<div>
<div class="MathJax_Preview">
KL\Big(N(\mu,\sigma^2)\Big\Vert N(0,1)\Big)=\frac{1}{2}\Big(-\log \sigma^2+\mu^2+\sigma^2-1\Big)
</div>
<script type="math/tex; mode=display">
KL\Big(N(\mu,\sigma^2)\Big\Vert N(0,1)\Big)=\frac{1}{2}\Big(-\log \sigma^2+\mu^2+\sigma^2-1\Big)
</script>
</div>
<p><span><span class="MathJax_Preview">\sigma^2 -\log \sigma^2 - 1</span><script type="math/tex">\sigma^2 -\log \sigma^2 - 1</script></span> 可以视为让<span><span class="MathJax_Preview">\sigma^2</span><script type="math/tex">\sigma^2</script></span>接近1的损失函数, 像一个对号形状的函数</p>
<pre><code>x = np.linspace(0.000001,20,100)
y = x - np.log(x) - 1
plt.plot(x, y)
</code></pre>

<p><span><span class="MathJax_Preview">\mu^2</span><script type="math/tex">\mu^2</script></span> 可以视为让<span><span class="MathJax_Preview">\mu</span><script type="math/tex">\mu</script></span>接近0的损失函数</p>
<p>p(x)为正态分布</p>
<div>
<div class="MathJax_Preview">p(x)=\frac{1}{\sqrt{{2\pi}}\times\sigma}e^{-\frac{1}{2}(\frac{x-\mu}{\sigma})^2}</div>
<script type="math/tex; mode=display">p(x)=\frac{1}{\sqrt{{2\pi}}\times\sigma}e^{-\frac{1}{2}(\frac{x-\mu}{\sigma})^2}</script>
</div>
<p>那么logp(x)为：</p>
<div>
<div class="MathJax_Preview">logp(x)=-\frac{1}{2} \big[ (\frac{x-\mu}{\sigma})^2+ \log \sigma^2+\log 2\pi\big]</div>
<script type="math/tex; mode=display">logp(x)=-\frac{1}{2} \big[ (\frac{x-\mu}{\sigma})^2+ \log \sigma^2+\log 2\pi\big]</script>
</div>
<h2 id="_2">代码实验</h2>
<p><a href="https://colab.research.google.com/drive/1PSigEhopMGZDGhyYPkscJmuPW_k-lkG6#scrollTo=yQXO_dlXkKsT">cvae</a></p>
<pre><code>  def reparameterize(self, mean, logvar):
    eps = tf.random_normal(shape=mean.shape)
    return eps * tf.exp(logvar * .5) + mean
</code></pre>

<p>eps 为标准正态分布采样， 然后根据均值和方差变换成新的正态分布
均值为μ，方差为σ的正态分布Z变换为标准正态分布X，变换公式如下：  <span><span class="MathJax_Preview">X=\frac{Z - μ}{σ}</span><script type="math/tex">X=\frac{Z - μ}{σ}</script></span> ;
标准正态分布X变换为均值为μ，方差为σ的正态分布Z，变换公式如下： <span><span class="MathJax_Preview">Z=X*σ + μ</span><script type="math/tex">Z=X*σ + μ</script></span></p>
<pre><code>def log_normal_pdf(sample, mean, logvar, raxis=1):
  log2pi = tf.log(2. * np.pi)
  return tf.reduce_sum(
      -.5 * ((sample - mean) ** 2. * tf.exp(-logvar) + logvar + log2pi),
      axis=raxis)

def compute_loss(model, x):
  mean, logvar = model.encode(x)
  z = model.reparameterize(mean, logvar)
  x_logit = model.decode(z)

  cross_ent = tf.nn.sigmoid_cross_entropy_with_logits(logits=x_logit, labels=x)
  logpx_z = -tf.reduce_sum(cross_ent, axis=[1, 2, 3])
  logpz = log_normal_pdf(z, 0., 0.)
  logqz_x = log_normal_pdf(z, mean, logvar)
  return -tf.reduce_mean(logpx_z + logpz - logqz_x)
</code></pre>

<ol>
<li>model.encode方法将输入图像x(batch_size, image_height, image_width, 1)变换成两个向量mean(batch_size,latent_dim)和logvar(batch_size, latent_dim)， 生成logvar而不是var是为了数值稳定性，每幅图像都对应一个私有的mean和logvar向量</li>
<li>model.reparameterize根据mean和logvar分布参数，来采样生成向量z(batch_size, latent_dim), 采样是为了进行蒙特卡洛估计</li>
<li>model.decode方法将向量z变换为重建图像x_logit(还未经过sigmoid)</li>
<li>log_normal_pdf normal指正态分布，pdf指概率密度函数，log_normal_pdf为概率密度函数取对数，结果仍然是个函数</li>
<li>z为均值为mean，方差的对数为logvar的采样样本</li>
<li>logpx_z为 <span><span class="MathJax_Preview">logP(X|Z)</span><script type="math/tex">logP(X|Z)</script></span>的采样, 因为现在X为二值图像,服从伯努利分布，所以计算交叉熵损失的cross_ent负数，如果图像为实值，则计算平方损失mse</li>
<li>logpz为 <span><span class="MathJax_Preview">logP(Z)</span><script type="math/tex">logP(Z)</script></span> 的采样， p(Z)为标准正态分布，因此mean=0,logvar=0</li>
<li>logqz_x为 <span><span class="MathJax_Preview">logQ(Z|X)</span><script type="math/tex">logQ(Z|X)</script></span>的采样, Q(Z|X)为正态分布</li>
<li>logpz - logqz_x 的期望可以不通过采样来进行计算，而是直接使用解析解进行计算</li>
</ol>
<p>交叉熵损失为：<span><span class="MathJax_Preview">\sum_{k=1}^D \Big[- x_{(k)} \ln \rho_{(k)}(z) - (1-x_{(k)}) \ln \Big(1 -\rho_{(k)}(z)\Big)\Big]</span><script type="math/tex">\sum_{k=1}^D \Big[- x_{(k)} \ln \rho_{(k)}(z) - (1-x_{(k)}) \ln \Big(1 -\rho_{(k)}(z)\Big)\Big]</script></span></p>
<p>对数似然为：<span><span class="MathJax_Preview">\ln p(x|z) = \sum_{k=1}^D \Big[ x_{(k)} \ln \rho_{(k)}(z) + (1-x_{(k)}) \ln \Big(1 -\rho_{(k)}(z)\Big)\Big]</span><script type="math/tex">\ln p(x|z) = \sum_{k=1}^D \Big[ x_{(k)} \ln \rho_{(k)}(z) + (1-x_{(k)}) \ln \Big(1 -\rho_{(k)}(z)\Big)\Big]</script></span>即交叉熵的负数</p>
<p>直接使用解析解求解logpz和logpz_x的期望， 和上边的区别是公式不同，没有使用采样点z</p>
<pre><code>def compute_loss(model, x):
  mean, logvar = model.encode(x)
  z = model.reparameterize(mean, logvar)
  x_logit = model.decode(z)

  cross_ent = tf.nn.sigmoid_cross_entropy_with_logits(logits=x_logit, labels=x)
  logpx_z = -tf.reduce_sum(cross_ent, axis=[1, 2, 3])
  logpz = tf.reduce_sum(-0.5*(tf.log(2. * np.pi) - 1 - logvar), axis=1)
  logqz_x = tf.reduce_sum(-0.5*(tf.log(2. * np.pi) - tf.square(mean) - tf.exp(logvar)), axis=1)
  return -tf.reduce_mean(logpx_z + logpz - logqz_x)
</code></pre>

<div>
<div class="MathJax_Preview"> KL\Big(p(x)\Big\Vert q(x)\Big) = \int p(x)\ln \frac{p(x)}{q(x)} dx=\mathbb{E}_{x\sim p(x)}\left[\ln \frac{p(x)}{q(x)}\right]\tag{5} </div>
<script type="math/tex; mode=display"> KL\Big(p(x)\Big\Vert q(x)\Big) = \int p(x)\ln \frac{p(x)}{q(x)} dx=\mathbb{E}_{x\sim p(x)}\left[\ln \frac{p(x)}{q(x)}\right]\tag{5} </script>
</div>
<p>联合分布的KL散度:</p>
<p><span><span class="MathJax_Preview">p(x,z)=\tilde{p}(x)p(z|x)</span><script type="math/tex">p(x,z)=\tilde{p}(x)p(z|x)</script></span></p>
<div>
<div class="MathJax_Preview">
\begin{aligned} 
KL\Big(p(x,z)\Big\Vert q(x,z)\Big) =&amp; \iint p(x,z)\ln \frac{p(x,z)}{q(x,z)} dxdz \\
=&amp; \int \tilde{p}(x) \left[\int p(z|x)\ln \frac{\tilde{p}(x)p(z|x)}{q(x,z)} dz\right]dx\\ 
=&amp; \mathbb{E}_{x\sim \tilde{p}(x)} \left[\int p(z|x)\ln \frac{\tilde{p}(x)p(z|x)}{q(x,z)} dz\right] \\
=&amp; \mathbb{E}_{x\sim \tilde{p}(x)} \left[\ln \tilde{p}(x)\int p(z|x)dz + \int p(z|x) \ln p(z|x)dz - \int p(z|x) \ln q(x,z)dz \right]\\ 
\end{aligned}
</div>
<script type="math/tex; mode=display">
\begin{aligned} 
KL\Big(p(x,z)\Big\Vert q(x,z)\Big) =& \iint p(x,z)\ln \frac{p(x,z)}{q(x,z)} dxdz \\
=& \int \tilde{p}(x) \left[\int p(z|x)\ln \frac{\tilde{p}(x)p(z|x)}{q(x,z)} dz\right]dx\\ 
=& \mathbb{E}_{x\sim \tilde{p}(x)} \left[\int p(z|x)\ln \frac{\tilde{p}(x)p(z|x)}{q(x,z)} dz\right] \\
=& \mathbb{E}_{x\sim \tilde{p}(x)} \left[\ln \tilde{p}(x)\int p(z|x)dz + \int p(z|x) \ln p(z|x)dz - \int p(z|x) \ln q(x,z)dz \right]\\ 
\end{aligned}
</script>
</div>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../2018-11-19-tensorflow_estimator/" title="Tensorflow Estimator" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Tensorflow Estimator
              </span>
            </div>
          </a>
        
        
          <a href="../2018-11-27-unsupervised learning/" title="Unsupervised Clustering" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Unsupervised Clustering
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/application.245445c6.js"></script>
      
      <script>app.initialize({version:"1.0.4",url:{base:"../.."}})</script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
      
    
  </body>
</html>