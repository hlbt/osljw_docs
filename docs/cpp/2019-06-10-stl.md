
---
layout:     post
title:      "stl"
subtitle:   "stl"
date:       2019-06-10 20:30:33
author:     "none"
header-img: "img/posts/default_post.jpg"
catalog: true
tags:
    - tag
---

# vector

## push_back 和 emplace_back
emplace_back会原地对参数进行构造，
push_back要么会拷贝参数，要么会构造后需要移动操作

## clear 
clear 后vector的size=0, 但capacity不变

如何改变vector的capacity
```
vector<T>().swap(var)
var.shrink_to_fit()
```

# 文件读写
不要使用eof进行判断，会导致循环多一次
```
#include <string>
#include <fstream>

int main() {
    std::ifstream in_file("doc_id.txt");
    if(!in_file.is_open()) return -1;

    std::string line;
    //while(!in_file.eof()) {
    while(in_file >> line) {
        std::getline(in_file, line);
    }
}
```


# 迭代器 iterator


## 迭代器失效

引起容器内存发生变化的操作，都有可能造成迭代器失效

插入和删除操作后，获取有效的迭代器
```
iter=vec.insert(iter);
iter=vec.erase(iter);
```

vector
- 插入操作(push_back, insert), vector中元素总数仍不大于capacity，这时插入位置后的元素都被依次移动到下一个位置，所以插入位置之后的迭代器都会失效; vector中元素总数大于capacity，这个时候会重新开辟更大的内存空间，将原来的vector中的内容复制到新的vector中，回收原先vector的内存空间。由于新的vector的地址已完全改变，所以原先的所有迭代器都会失效。
- 删除操作(pop_back, erase), 删除位置后的元素都被依次复制到前一个位置，所以删除位置之后的迭代器都会失效。